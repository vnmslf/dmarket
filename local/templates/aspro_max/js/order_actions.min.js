function orderActions(e){if(arAsproOptions.PAGES.ORDER_PAGE){if($("#bx-soa-order input[autocomplete=tel]").length){for(var o=0;o<BX.Sale.OrderAjaxComponent.result.ORDER_PROP.properties.length;++o)if("Y"==BX.Sale.OrderAjaxComponent.result.ORDER_PROP.properties[o].IS_PHONE)var a=BX.Sale.OrderAjaxComponent.result.ORDER_PROP.properties[o];if(void 0!==BX.Sale.OrderAjaxComponent&&"object"==typeof BX.Sale.OrderAjaxComponent&&"object"==typeof a&&a&&"object"==typeof appAspro&&appAspro&&appAspro.phone){BX.Sale.OrderAjaxComponent.validatePhone=function(e,o,a){if(!e||!o)return[];var r=e.value,t=[],n=BX.util.htmlspecialchars(o.NAME),i=BX.message("SOA_FIELD")+' "'+n+'"';return"Y"==o.REQUIRED&&0==r.length&&t.push(i+" "+BX.message("SOA_REQUIRED")),"Y"==o.IS_PHONE&&r.length>0&&(this.validateNormalPhone(e,t,i),this.validateIntlPhone(e,t,i)),t},BX.Sale.OrderAjaxComponent.validateNormalPhone=function(e,o,a){arAsproOptions.THEME.PHONE_MASK&&arAsproOptions.THEME.VALIDATE_PHONE_MASK&&!appAspro.phone.checkIntlPhone&&(new RegExp(arAsproOptions.THEME.VALIDATE_PHONE_MASK).test($(e).val())||o.push(a+" "+BX.message("JS_FORMAT_ORDER")))},BX.Sale.OrderAjaxComponent.validateIntlPhone=function(e,o,a){if(appAspro.phone.checkIntlPhone){const a=$(e).data("iti");if(a){a.isValidNumber()||o.push(BX.message(appAspro.phone.errorMap[a.getValidationError()]))}}},BX.Sale.OrderAjaxComponent.getValidationDataPhone=function(e,o){var a,r={};switch(e.TYPE){case"STRING":if(r.action="blur",r.func=BX.delegate((function(o,a){return this.validatePhone(o,e,a)}),this),a=o.querySelectorAll("input[type=tel]"),$(a).length){r.inputs=a;break}}return r},BX.Sale.OrderAjaxComponent.bindValidationPhone=function(e,o){if(this.validation.properties&&this.validation.properties[e]){var a,r=this.validation.properties[e],t=this.getValidationDataPhone(r,o);if(t&&t.inputs&&t.action)for(a=0;a<$(t.inputs).length;a++)BX.type.isElementNode(t.inputs[a])&&(appAspro.phone.init($(t.inputs[a])),BX.bind(t.inputs[a],t.action,BX.delegate((function(){this.isValidProperty(t)}),this)))}},BX.Sale.OrderAjaxComponent.isValidPropertiesBlock=function(e){if(!this.options.propertyValidation)return[];var o,a,r,t,n,i=this.orderBlockNode.querySelectorAll(".bx-soa-customer-field[data-property-id-row]"),l=[];for(n=0;n<i.length;n++)o=i[n].getAttribute("data-property-id-row"),e&&this.locations[o]||(a=i[n].querySelector(".soa-property-container"))&&(r=this.validation.properties[o],t=this.getValidationData(r,a),dataPhone=this.getValidationDataPhone(r,a),t=$.extend({},t,dataPhone),l=l.concat(this.isValidProperty(t,!0)));return l};const e=document.querySelectorAll("#bx-soa-order input[autocomplete=tel]");if(1===e.length){const o=e[0].cloneNode(!0);o.type="tel",o.addEventListener("blur",(function(){const e=this.closest(".soa-property-container"),o=e&&e.querySelector("input[autocomplete=tel][type=text]");o&&(o.value=this.value)})),e[0].style.display="none",e[0].after(o)}BX.Sale.OrderAjaxComponent.bindValidationPhone(a.ID,$("input[autocomplete=tel]").parent()[0])}}if($(".bx-soa-cart-total").length){if($(".change_basket").length||$(".bx-soa-cart-total").prepend('<div class="change_basket">'+BX.message("BASKET_CHANGE_TITLE")+'<a href="'+arAsproOptions.SITE_DIR+'basket/" class="change_link">'+BX.message("BASKET_CHANGE_LINK")+"</a></div>"),"object"==typeof BX.Sale.OrderAjaxComponent){if("N"!==arAsproOptions.COUNTERS.USE_FULLORDER_GOALS&&void 0===BX.Sale.OrderAjaxComponent.reachgoalbegin){BX.Sale.OrderAjaxComponent.reachgoalbegin=!0;BX.onCustomEvent("onCounterGoals",[{goal:"goal_order_begin"}])}BX.Sale.OrderAjaxComponent.hasOwnProperty("params")&&($(".bx-soa-cart-total .change_link").attr("href",BX.Sale.OrderAjaxComponent.params.PATH_TO_BASKET),arAsproOptions.PRICES.MIN_PRICE&&arAsproOptions.PRICES.MIN_PRICE>Number(BX.Sale.OrderAjaxComponent.result.TOTAL.ORDER_PRICE)&&($('<div class="fademask_ext"></div>').appendTo($("body")),location.href=BX.Sale.OrderAjaxComponent.params.PATH_TO_BASKET));const o=BX.message("REQUIRED_TEXT");if($("#bx-soa-auth").length&&!$("#bx-soa-auth .redisigned").length){if($('input[name="USER_LOGIN"]').length)(l=$('input[name="USER_LOGIN"]').closest(".bx-authform-formgroup-container").find(".bx-authform-label-container")).find(".bx-authform-starrequired").length||l.html(l.html()+'<span class="bx-authform-starrequired"> *</span>');if($('input[name="USER_PASSWORD"]').length)(l=$('input[name="USER_PASSWORD"]').closest(".bx-authform-formgroup-container").find(".bx-authform-label-container")).find(".bx-authform-starrequired").length||l.html(l.html()+'<span class="bx-authform-starrequired"> *</span>');if($('.checkbox label input[name="USER_REMEMBER"]').length){const e=$('input[name="USER_REMEMBER"]').attr("id","ORDER_AUTH_USER_REMEMBER"),o=e.closest(".bx-authform-formgroup-container"),a=o.find("label"),r=o.find(".checkbox"),t=$("#bx-soa-auth .bx-authform > a").wrap('<div id="trem_">').parent().html();$("#trem_").remove(),e.prependTo(r),a.attr("for","ORDER_AUTH_USER_REMEMBER").html(a.text()),o.addClass("filter").wrapInner("<div class='line-block flexbox--wrap justify-content-between'><div class='line-block__item'></div></div>"),r.addClass("onoff"),$(".bx-authform-formgroup-container.filter .line-block").append("<div class='line-block__item'>"+t+"</div>")}$(".bx-authform .form_footer__bottom").length||($(".bx-authform .btn-default").parent().wrapInner("<div class='line-block form_footer__bottom'><div class='line-block__item'></div></div>"),$(".bx-authform .form_footer__bottom").append("<div class='line-block__item'>"+o+"</div>")),$("#bx-soa-auth .bx-soa-reg-block .btn").addClass("btn-lg").text(BX.message("ORDER_REGISTER_BUTTON")),$("#bx-soa-auth").append('<div class="redisigned hidden></div>'),$(".bx-authform").addClass("active")}if(!$("#bx-soa-auth:visible").length)if($("#bx-soa-order.orderform--v1").length){const e=$(".bx_soa_location.row, #bx-soa-properties .bx-soa-section-content .row");e.length&&o&&e.each((function(){$(this).find(".required-fields-note").length||$('<div class="col-xs-12 required-fields-note__container">'+o+"</div>").appendTo($(this))}))}else if($("#bx-soa-order-main.orderform--v2").length){const e=$(".bx-soa-customer .group-without-margin, #bx-soa-delivery .bx-soa-pp");e.length&&e.each((function(){$(this).find(".required-fields-note").length||$('<div class="col-xs-12 required-fields-note__container"><div class="bx-soa-pp-company-item">'+o+"</div></div>").appendTo($(this))}))}if($(".bx-authform").length&&!$(".bx-soa-section-content.reg .redisigned").length){var r=!1;if("Y"===arAsproOptions.THEME.LOGIN_EQUAL_EMAIL&&(r=!0,$('input[name="NEW_LOGIN"]').length&&$('input[name="NEW_LOGIN"]').closest(".bx-authform-formgroup-container").hide()),"Y"===arAsproOptions.THEME.PERSONAL_ONEFIO&&(r=!0,$('input[name="NEW_NAME"]').length&&$('input[name="NEW_NAME"]').closest(".bx-authform-formgroup-container").find(".bx-authform-label-container").html(BX.message("ORDER_FIO_LABEL")+'<span class="bx-authform-starrequired"> *</span>'),$('input[name="NEW_LAST_NAME"]').length&&($('input[name="NEW_LAST_NAME"]').closest(".bx-authform-formgroup-container").hide(),$('input[name="NEW_LAST_NAME"]').val(" "))),r){var t=$("#do_register~input[type=submit]");t.length&&(BX.unbindAll(t[0]),$(document).on("click","#do_register~input[type=submit]",(function(e){if(e.preventDefault(),e.stopImmediatePropagation(),"Y"===arAsproOptions.THEME.LOGIN_EQUAL_EMAIL){var o=BX.findChild(BX("bx-soa-auth"),{attribute:{name:"NEW_EMAIL"}},!0,!1),a=BX.findChild(BX("bx-soa-auth"),{attribute:{name:"NEW_LOGIN"}},!0,!1);a&&o&&(a.value=o.value)}BX("do_register").value="Y",BX.Sale.OrderAjaxComponent.sendRequest("showAuthForm")})))}var n=$(".bx-soa-section-content.reg").find(".bx-captcha");if(n.length&&(n.addClass("captcha_image"),n.find(".captcha_reload").length||n.append('<div class="captcha_reload"></div>'),n.closest(".bx-authform-formgroup-container").addClass("captcha-row").find("input[name=captcha_word]").closest(".bx-authform-input-container").addClass("captcha_input"),BX.onCustomEvent("onRenderCaptcha")),$(".bx-authform-input-container:not(.eye-password-ignore) [type=password]").each((function(e){$(this).closest(".bx-authform-input-container").addClass("eye-password")})),$("input[name=NEW_NAME]").length&&$("input[name=NEW_LAST_NAME]").length&&"Y"!==arAsproOptions.THEME.PERSONAL_ONEFIO&&!$("input[name=NEW_NAME]").closest(".bx-authform-formgroup-container.col-md-6").length){$("input[name=NEW_NAME],input[name=NEW_LAST_NAME]").closest(".bx-authform-formgroup-container").addClass("col-md-6");var i=$("input[name=NEW_LAST_NAME]").closest(".bx-authform-formgroup-container").wrap('<div id="trem_"></div>').parent().html();$("#trem_").remove(),$(i).insertAfter($("input[name=NEW_NAME]").closest(".bx-authform-formgroup-container").wrap('<div class="row"></div>'))}if($("input[name=NEW_EMAIL]").length&&$("input[name=PHONE_NUMBER]").length&&!$("input[name=PHONE_NUMBER]").closest(".bx-authform-formgroup-container.col-md-6").length){$("input[name=NEW_EMAIL],input[name=PHONE_NUMBER]").closest(".bx-authform-formgroup-container").addClass("col-md-6");i=$("input[name=PHONE_NUMBER]").closest(".bx-authform-formgroup-container").wrap('<div id="trem_"></div>').parent().html();$("#trem_").remove(),$(i).insertAfter($("input[name=NEW_EMAIL]").closest(".bx-authform-formgroup-container").wrap('<div class="row"></div>'))}if($("input[name=NEW_PASSWORD]").length&&$("input[name=NEW_PASSWORD_CONFIRM]").length&&!$("input[name=NEW_PASSWORD]").closest(".bx-authform-formgroup-container.col-md-6").length){$("input[name=NEW_PASSWORD],input[name=NEW_PASSWORD_CONFIRM]").closest(".bx-authform-formgroup-container").addClass("col-md-6");i=$("input[name=NEW_PASSWORD_CONFIRM]").closest(".bx-authform-formgroup-container").wrap('<div id="trem_"></div>').parent().html();$("#trem_").remove(),$(i).insertAfter($("input[name=NEW_PASSWORD]").closest(".bx-authform-formgroup-container").wrap('<div class="row"></div>'))}if($("input[name=PHONE_NUMBER]").length){var l,d=$("input[name=PHONE_NUMBER]"),s=(d[0].outerHTML,d.val()),c=d[0].outerHTML.replace('type="text"','type="tel" value="'+s+'"');if($(d).length<2)d.hide(),$(c).insertAfter(d),showPhoneMask("input[name=PHONE_NUMBER][type=tel]"),$("input[name=PHONE_NUMBER][type=tel]").on("blur",(function(){var e=$(this),o=e.val();e.data("intl-tel-input-id")?e.closest(".bx-authform-input-container").find("input[name=PHONE_NUMBER][type=text]").val(o):e.parent().find("input[name=PHONE_NUMBER][type=text]").val(o)})),(l=$("input[name=PHONE_NUMBER][type=tel]").closest(".bx-authform-formgroup-container").find(".bx-authform-label-container")).html(BX.message("ORDER_PHONE_LABEL")+(l.find(".bx-authform-starrequired").length?'<span class="bx-authform-starrequired"> *</span>':""))}$(".bx-soa-section-content.reg").append('<div class="redisigned hidden></div>')}var p,m,u="Y"==arAsproOptions.THEME.SHOW_LICENCE,h="Y"==arAsproOptions.THEME.SHOW_OFFER;if($(".bx-soa-cart-total-line-total").length&&(u||h)&&(void 0===e&&(BX.Sale.OrderAjaxComponent.state_licence="Y"==arAsproOptions.THEME.LICENCE_CHECKED?"checked":"",BX.Sale.OrderAjaxComponent.state_offer="Y"==arAsproOptions.THEME.OFFER_CHECKED?"checked":""),(!$(".licence_block.filter").length&&u||!$(".offer_block.filter").length&&h)&&($('<div class="form"><div class="license_order_wrap"></div></div>').insertBefore($("#bx-soa-orderSave")),!$(".licence_block.filter").length&&u&&$('<div class="licence_block filter label_block onoff"><label data-for="licenses_order" class="hidden error">'+BX.message("JS_REQUIRED_LICENSES")+'</label><input type="checkbox" name="licenses_order" required '+BX.Sale.OrderAjaxComponent.state_licence+' value="Y"><label data-for="licenses_order" class="license">'+BX.message("LICENSES_TEXT")+"</label></div>").appendTo($(".license_order_wrap")),!$(".offer_block.filter").length&&h&&$('<div class="offer_block filter label_block onoff"><label data-for="offer_order" class="hidden error">'+BX.message("JS_REQUIRED_OFFER")+'</label><input type="checkbox" name="offer_order" required '+BX.Sale.OrderAjaxComponent.state_offer+' value="Y"><label data-for="offer_order" class="offer_pub">'+BX.message("OFFER_TEXT")+"</label></div>").appendTo($(".license_order_wrap")),u&&$(document).on("click",".bx-soa .licence_block label.license",(function(){var e=$(this).data("for");$(".bx-soa .licence_block label.error").addClass("hidden"),$("input[name="+e+"]").prop("checked")?($("input[name="+e+"]").prop("checked",""),BX.Sale.OrderAjaxComponent.state_licence=""):($("input[name="+e+"]").prop("checked","checked"),BX.Sale.OrderAjaxComponent.state_licence="checked")})),h&&$(document).on("click",".bx-soa .offer_block label.offer_pub",(function(){var e=$(this).data("for");$(".bx-soa .offer_block label.error").addClass("hidden"),$("input[name="+e+"]").prop("checked")?($("input[name="+e+"]").prop("checked",""),BX.Sale.OrderAjaxComponent.state_offer=""):($("input[name="+e+"]").prop("checked","checked"),BX.Sale.OrderAjaxComponent.state_offer="checked")})),$(document).on("click",".lic_condition a",(function(){if(BX.hasClass(BX("bx-soa-order"),"orderform--v1"))BX.Sale.OrderAjaxComponent.isValidForm()&&BX.Sale.OrderAjaxComponent.animateScrollTo($(".licence_block, .offer_block")[0],800,50);else{var e=BX.Sale.OrderAjaxComponent.isValidPropertiesBlock().length;BX.Sale.OrderAjaxComponent.activeSectionId&&e||BX.Sale.OrderAjaxComponent.animateScrollTo($(".licence_block, .offer_block")[0],800,50)}}))),$("#bx-soa-orderSave, .bx-soa-cart-total-button-container").addClass("lic_condition"),void 0===BX.Sale.OrderAjaxComponent.oldClickOrderSaveAction&&void 0!==BX.Sale.OrderAjaxComponent.clickOrderSaveAction&&(BX.Sale.OrderAjaxComponent.oldClickOrderSaveAction=BX.Sale.OrderAjaxComponent.clickOrderSaveAction,BX.Sale.OrderAjaxComponent.clickOrderSaveAction=function(e){!$('input[name="licenses_order"]').prop("checked")&&u||!$('input[name="offer_order"]').prop("checked")&&h?($('input[name="licenses_order"]').prop("checked")||$(".bx-soa .licence_block label.error").removeClass("hidden"),$('input[name="offer_order"]').prop("checked")||$(".bx-soa .offer_block label.error").removeClass("hidden")):($(".bx-soa .licence_block label.error").addClass("hidden"),$(".bx-soa .offer_block label.error").addClass("hidden"),BX.Sale.OrderAjaxComponent.isValidForm()&&("function"==typeof BX.Sale.OrderAjaxComponent.allowOrderSave&&BX.Sale.OrderAjaxComponent.allowOrderSave(),"function"==typeof BX.Sale.OrderAjaxComponent.doSaveAction?BX.Sale.OrderAjaxComponent.doSaveAction():BX.Sale.OrderAjaxComponent.oldClickOrderSaveAction(e)))},BX.Sale.OrderAjaxComponent.orderSaveBlockNode.querySelector(".checkbox")&&"object"==typeof browser&&("msie"in browser&&browser.msie?$(BX.Sale.OrderAjaxComponent.orderSaveBlockNode.querySelector(".checkbox")).remove():BX.Sale.OrderAjaxComponent.orderSaveBlockNode.querySelector(".checkbox").remove()),BX.unbindAll(BX.Sale.OrderAjaxComponent.totalInfoBlockNode.querySelector("a.btn-order-save")),BX.unbindAll(BX.Sale.OrderAjaxComponent.mobileTotalBlockNode.querySelector("a.btn-order-save")),BX.unbindAll(BX.Sale.OrderAjaxComponent.orderSaveBlockNode.querySelector("a")),BX.bind(BX.Sale.OrderAjaxComponent.totalInfoBlockNode.querySelector("a.btn-order-save"),"click",BX.proxy(BX.Sale.OrderAjaxComponent.clickOrderSaveAction,BX.Sale.OrderAjaxComponent)),BX.bind(BX.Sale.OrderAjaxComponent.mobileTotalBlockNode.querySelector("a.btn-order-save"),"click",BX.proxy(BX.Sale.OrderAjaxComponent.clickOrderSaveAction,BX.Sale.OrderAjaxComponent)),BX.bind(BX.Sale.OrderAjaxComponent.orderSaveBlockNode.querySelector("a"),"click",BX.proxy(BX.Sale.OrderAjaxComponent.clickOrderSaveAction,BX.Sale.OrderAjaxComponent)))),$(window).scroll(),checkCounters()&&void 0===BX.Sale.OrderAjaxComponent.oldSaveOrder){var f=void 0!==BX.Sale.OrderAjaxComponent.saveOrder?"saveOrder":"saveOrderWithJson";void 0!==BX.Sale.OrderAjaxComponent[f]&&(BX.Sale.OrderAjaxComponent.oldSaveOrder=BX.Sale.OrderAjaxComponent[f],BX.Sale.OrderAjaxComponent[f]=function(e){var o=BX.parseJSON(e);o&&o.order?o.order.SHOW_AUTH?BX.Sale.OrderAjaxComponent.oldSaveOrder(e):o.order.REDIRECT_URL&&o.order.REDIRECT_URL.length&&(!o.order.ERROR||BX.util.object_keys(o.order.ERROR).length<1)&&(arMatch=o.order.REDIRECT_URL.match(/ORDER_ID\=[^&=]*/g))&&arMatch.length&&(_id=arMatch[0].replace(/ORDER_ID\=/g,"",arMatch[0]))?$.ajax({url:arAsproOptions.SITE_DIR+"ajax/check_order.php",dataType:"json",type:"POST",data:{ID:_id},success:function(o){parseInt(o)?purchaseCounter(parseInt(o),BX.message("FULL_ORDER"),(function(o){"undefined"!=typeof localStorage&&"object"==typeof o&&localStorage.setItem("gtm_e_"+_id,JSON.stringify(o)),BX.Sale.OrderAjaxComponent.oldSaveOrder(e)})):BX.Sale.OrderAjaxComponent.oldSaveOrder(e)},error:function(){BX.Sale.OrderAjaxComponent.oldSaveOrder(e)}}):BX.Sale.OrderAjaxComponent.oldSaveOrder(e):BX.Sale.OrderAjaxComponent.oldSaveOrder(e)})}if($("#bx-soa-order-form .captcha-row").length&&window.asproRecaptcha&&window.asproRecaptcha.key&&"invisible"==window.asproRecaptcha.params.recaptchaSize&&($("#bx-soa-order-form .captcha-row").addClass("invisible"),"n"===asproRecaptcha.params.recaptchaLogoShow&&$("#bx-soa-order-form .captcha-row").addClass("logo_captcha_n")),$("#bx-soa-order-form .captcha-row.invisible").length)if(void 0===BX.Sale.OrderAjaxComponent.oldSendRequest&&void 0!==BX.Sale.OrderAjaxComponent.sendRequest)BX.Sale.OrderAjaxComponent.oldSendRequest=BX.Sale.OrderAjaxComponent.sendRequest,BX.Sale.OrderAjaxComponent.sendRequest=function(e,o){var a=!0;if($("#bx-soa-order-form .captcha-row.invisible").length&&window.renderRecaptchaById&&window.asproRecaptcha&&window.asproRecaptcha.key&&"invisible"==window.asproRecaptcha.params.recaptchaSize){var r=BX("bx-soa-order-form");$(r).find(".g-recaptcha").length&&($(r).find(".g-recaptcha-response").val()?a=!0:"undefined"!=typeof grecaptcha?(grecaptcha.execute($(r).find(".g-recaptcha").data("widgetid")),a=!1):a=!1)}a?BX.Sale.OrderAjaxComponent.oldSendRequest(e,o):(p=e,m=o)},$(document).on("submit","#bx-soa-order-form",(function(e){e.preventDefault(),void 0===p&&void 0===m||(BX.Sale.OrderAjaxComponent.sendRequest(p,m),p=void 0,m=void 0)}));$("#bx-soa-order-form .captcha-row").length&&"3"===window.asproRecaptcha.ver&&void 0===BX.Sale.OrderAjaxComponent.oldSendRequest&&void 0!==BX.Sale.OrderAjaxComponent.sendRequest&&(BX.Sale.OrderAjaxComponent.oldSendRequest=BX.Sale.OrderAjaxComponent.sendRequest,BX.Sale.OrderAjaxComponent.sendRequest=function(e,o){if($("#bx-soa-order-form .captcha-row").length&&"undefined"!=typeof grecaptcha){if(window.renderRecaptchaById&&window.asproRecaptcha&&window.asproRecaptcha.key){let a=BX("bx-soa-order-form");grecaptcha.execute(window.asproRecaptcha.key,{action:"maxscore"}).then((function(r){const t=a.querySelector(".g-recaptcha-response");t&&(t.value=r),BX.Sale.OrderAjaxComponent.oldSendRequest(e,o)}))}}else BX.Sale.OrderAjaxComponent.oldSendRequest(e,o)})}$(".bx-ui-sls-quick-locations.quick-locations").on("click",(function(){$(this).siblings().removeClass("active"),$(this).addClass("active")}))}}}